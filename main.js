(()=>{"use strict";class t{constructor(t){this.taskList=t}renderTasks(t){t.forEach((t=>{"v"!==t.task.querySelector(".status").innerText?this.taskList.filterList.appendChild(t.task):this.taskList.pinnedList.appendChild(t.task)}))}renderNoTasks(t){let s,e;Array.isArray(t)?(s=this.taskList.filterList.querySelector(".no-found"),e=t.length):(s=t.querySelector(".no-found"),e=[...t.querySelectorAll(".task-item")].length),0===e?s.classList.remove("hidden"):s.classList.add("hidden")}static clearList(t){[...t.querySelectorAll(".task-item")].forEach((t=>t.remove()))}}const s=(t,s)=>function(t,s){const e=s.trim().toLowerCase();return t.toLowerCase().includes(e)}(s.task.querySelector(".value").innerText,t);class e{constructor(s){this.taskList=s,this.renderTask=new t(this.taskList),this.filterTasks=this.filterTasks.bind(this)}filterTasks(e){this.taskList.input=e;const i=(a=s.bind(null,e),this.taskList.filterItems.filter(a));var a;this.renderTask.renderNoTasks(i),t.clearList(this.taskList.filterList),this.renderTask.renderTasks(i)}}class i{constructor(t){this.task=t}}class a{constructor(s){this.taskList=s,this.renderTasks=new t(this.taskList),this.addTask=this.addTask.bind(this)}addTask(s){const e=a.getTaskHTML(s),r=new i(e);this.taskList.taskItems.push(r),this.taskList.filterItems.push(r),t.clearList(this.taskList.filterList),this.renderTasks.renderTasks(this.taskList.filterItems),this.renderTasks.renderNoTasks(this.taskList.filterList),this.taskList.input=""}static getTaskHTML(t){const s=document.createElement("li");s.className="task-item",s.dataset.id=Date.now();const e=document.createElement("span");e.className="value",e.innerText=t;const i=document.createElement("span");return i.className="status",s.appendChild(e),s.appendChild(i),s}}const r=new class{constructor(s){"string"==typeof s&&(this.elements=[...document.querySelectorAll(s)]),[this.pinnedList,this.filterList]=this.elements,this.taskListFilter=new e(this),this.renderTasks=new t(this),this.taskItems=[],this.filterItems=[],this.input="",this.onChangeStatus=this.onChangeStatus.bind(this),this.pinnedList.addEventListener("click",this.onChangeStatus),this.filterList.addEventListener("click",this.onChangeStatus),this.renderTasks.renderNoTasks(this.pinnedList)}onChangeStatus(t){if(!t.target.className.includes("status"))return;const s=t.target,e=t.target.closest(".task-item");"v"!==s.innerText?this.fromFilterToPin(e):this.fromPinToFilter(e)}fromPinToFilter(t){const s=this.taskItems.find((s=>s.task.dataset.id===t.dataset.id));s.task.querySelector(".status").innerText="",this.filterItems.push(s),this.reloadTasks()}fromFilterToPin(t){const s=this.taskItems.find((s=>s.task.dataset.id===t.dataset.id)),e=this.filterItems.findIndex((s=>s.task.dataset.id===t.dataset.id));this.filterItems.splice(e,1),s.task.querySelector(".status").innerText="v",this.reloadTasks()}reloadTasks(){t.clearList(this.filterList),t.clearList(this.pinnedList),this.renderTasks.renderTasks(this.taskItems),this.renderTasks.renderNoTasks(this.pinnedList),this.taskListFilter.filterTasks(this.input)}}(".task-list"),n=new a(r),l=new e(r);new class{constructor(t,s,e){this.element="string"==typeof t?document.querySelector(t):t,this.addTaskHandler=s,this.filterHandler=e,this.onClickAddTask=this.onClickAddTask.bind(this),this.element.addEventListener("submit",this.onClickAddTask),this.onFilterTasks=this.onFilterTasks.bind(this),this.element.addEventListener("input",this.onFilterTasks)}onClickAddTask(t){t.preventDefault();const s=this.element.querySelector(".input").value,e=document.querySelector(".error");if(!s.trim())throw new Error("Пожалуйста, введите корректную задачу.");e.innerText="",this.addTaskHandler(s),this.element.reset()}onFilterTasks(){const t=this.element.querySelector(".input").value;this.filterHandler(t)}}(".form",n.addTask,l.filterTasks)})();